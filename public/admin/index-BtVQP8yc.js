import{r as m,bD as X,ar as De}from"./index-C9q2FBSY.js";var Ve=function(n){return function(e,r){var t=m.useRef(!1);n(function(){return function(){t.current=!1}},[]),n(function(){if(!t.current)t.current=!0;else return e()},r)}},b=function(){return b=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b.apply(this,arguments)};function Q(n,e){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.indexOf(t)<0&&(r[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(n);i<t.length;i++)e.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(n,t[i])&&(r[t[i]]=n[t[i]]);return r}function ke(n,e,r,t){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function f(d){try{u(t.next(d))}catch(l){o(l)}}function c(d){try{u(t.throw(d))}catch(l){o(l)}}function u(d){d.done?a(d.value):i(d.value).then(f,c)}u((t=t.apply(n,e||[])).next())})}function Ue(n,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},t,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=f(0),o.throw=f(1),o.return=f(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function f(u){return function(d){return c([u,d])}}function c(u){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(t=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(n,r)}catch(d){u=[6,d],i=0}finally{t=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function S(n,e){var r=typeof Symbol=="function"&&n[Symbol.iterator];if(!r)return n;var t=r.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=t.next()).done;)a.push(i.value)}catch(f){o={error:f}}finally{try{i&&!i.done&&(r=t.return)&&r.call(t)}finally{if(o)throw o.error}}return a}function P(n,e,r){if(r||arguments.length===2)for(var t=0,i=e.length,a;t<i;t++)(a||!(t in e))&&(a||(a=Array.prototype.slice.call(e,0,t)),a[t]=e[t]);return n.concat(a||Array.prototype.slice.call(e))}var $e=function(n){return typeof n=="function"};function q(n){var e=m.useRef(n);e.current=m.useMemo(function(){return n},[n]);var r=m.useRef();return r.current||(r.current=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.current.apply(this,t)}),r.current}const B=Ve(m.useEffect);var Ie=function(n,e){var r=e.manual,t=e.ready,i=t===void 0?!0:t,a=e.defaultParams,o=a===void 0?[]:a,f=e.refreshDeps,c=f===void 0?[]:f,u=e.refreshDepsAction,d=m.useRef(!1);return d.current=!1,B(function(){!r&&i&&(d.current=!0,n.run.apply(n,P([],S(o),!1)))},[i]),B(function(){d.current||r||(d.current=!0,u?u():n.refresh())},P([],S(c),!1)),{onBefore:function(){if(!i)return{stopNow:!0}}}};Ie.onInit=function(n){var e=n.ready,r=e===void 0?!0:e,t=n.manual;return{loading:!t&&r}};function Xe(n,e){if(n===e)return!0;for(var r=0;r<n.length;r++)if(!Object.is(n[r],e[r]))return!1;return!0}function Me(n,e){var r=m.useRef({deps:e,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!Xe(r.deps,e))&&(r.deps=e,r.obj=n(),r.initialized=!0),r.obj}function Le(n){var e=m.useRef(n);return e.current=n,e}var he=function(n){var e=Le(n);m.useEffect(function(){return function(){e.current()}},[])},J=new Map,Je=function(n,e,r){var t=J.get(n);t!=null&&t.timer&&clearTimeout(t.timer);var i=void 0;e>-1&&(i=setTimeout(function(){J.delete(n)},e)),J.set(n,b(b({},r),{timer:i}))},Ke=function(n){return J.get(n)},K=new Map,Qe=function(n){return K.get(n)},Ye=function(n,e){K.set(n,e),e.then(function(r){return K.delete(n),r}).catch(function(){K.delete(n)})},N={},Ze=function(n,e){N[n]&&N[n].forEach(function(r){return r(e)})},ee=function(n,e){return N[n]||(N[n]=[]),N[n].push(e),function(){var t=N[n].indexOf(e);N[n].splice(t,1)}},er=function(n,e){var r=e.cacheKey,t=e.cacheTime,i=t===void 0?5*60*1e3:t,a=e.staleTime,o=a===void 0?0:a,f=e.setCache,c=e.getCache,u=m.useRef(),d=m.useRef(),l=function(v,s){f?f(s):Je(v,i,s),Ze(v,s.data)},g=function(v,s){return s===void 0&&(s=[]),c?c(s):Ke(v)};return Me(function(){if(r){var v=g(r);v&&Object.hasOwnProperty.call(v,"data")&&(n.state.data=v.data,n.state.params=v.params,(o===-1||new Date().getTime()-v.time<=o)&&(n.state.loading=!1)),u.current=ee(r,function(s){n.setState({data:s})})}},[]),he(function(){var v;(v=u.current)===null||v===void 0||v.call(u)}),r?{onBefore:function(v){var s=g(r,v);return!s||!Object.hasOwnProperty.call(s,"data")?{}:o===-1||new Date().getTime()-s.time<=o?{loading:!1,data:s==null?void 0:s.data,error:void 0,returnNow:!0}:{data:s==null?void 0:s.data,error:void 0}},onRequest:function(v,s){var p=Qe(r);return p&&p!==d.current?{servicePromise:p}:(p=v.apply(void 0,P([],S(s),!1)),d.current=p,Ye(r,p),{servicePromise:p})},onSuccess:function(v,s){var p;r&&((p=u.current)===null||p===void 0||p.call(u),l(r,{data:v,params:s,time:new Date().getTime()}),u.current=ee(r,function(T){n.setState({data:T})}))},onMutate:function(v){var s;r&&((s=u.current)===null||s===void 0||s.call(u),l(r,{data:v,params:n.state.params,time:new Date().getTime()}),u.current=ee(r,function(p){n.setState({data:p})}))}}:{}},re,ye;function be(){if(ye)return re;ye=1;function n(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return re=n,re}var ne,Se;function rr(){if(Se)return ne;Se=1;var n=typeof X=="object"&&X&&X.Object===Object&&X;return ne=n,ne}var te,Te;function Ne(){if(Te)return te;Te=1;var n=rr(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=n||e||Function("return this")();return te=r,te}var ie,Re;function nr(){if(Re)return ie;Re=1;var n=Ne(),e=function(){return n.Date.now()};return ie=e,ie}var ae,Pe;function tr(){if(Pe)return ae;Pe=1;var n=/\s/;function e(r){for(var t=r.length;t--&&n.test(r.charAt(t)););return t}return ae=e,ae}var ue,we;function ir(){if(we)return ue;we=1;var n=tr(),e=/^\s+/;function r(t){return t&&t.slice(0,n(t)+1).replace(e,"")}return ue=r,ue}var oe,_e;function We(){if(_e)return oe;_e=1;var n=Ne(),e=n.Symbol;return oe=e,oe}var ce,Oe;function ar(){if(Oe)return ce;Oe=1;var n=We(),e=Object.prototype,r=e.hasOwnProperty,t=e.toString,i=n?n.toStringTag:void 0;function a(o){var f=r.call(o,i),c=o[i];try{o[i]=void 0;var u=!0}catch{}var d=t.call(o);return u&&(f?o[i]=c:delete o[i]),d}return ce=a,ce}var fe,je;function ur(){if(je)return fe;je=1;var n=Object.prototype,e=n.toString;function r(t){return e.call(t)}return fe=r,fe}var le,Ee;function or(){if(Ee)return le;Ee=1;var n=We(),e=ar(),r=ur(),t="[object Null]",i="[object Undefined]",a=n?n.toStringTag:void 0;function o(f){return f==null?f===void 0?i:t:a&&a in Object(f)?e(f):r(f)}return le=o,le}var se,Fe;function cr(){if(Fe)return se;Fe=1;function n(e){return e!=null&&typeof e=="object"}return se=n,se}var de,xe;function fr(){if(xe)return de;xe=1;var n=or(),e=cr(),r="[object Symbol]";function t(i){return typeof i=="symbol"||e(i)&&n(i)==r}return de=t,de}var ve,Ce;function lr(){if(Ce)return ve;Ce=1;var n=ir(),e=be(),r=fr(),t=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,f=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return t;if(e(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=e(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=n(u);var l=a.test(u);return l||o.test(u)?f(u.slice(2),l?2:8):i.test(u)?t:+u}return ve=c,ve}var ge,qe;function Be(){if(qe)return ge;qe=1;var n=be(),e=nr(),r=lr(),t="Expected a function",i=Math.max,a=Math.min;function o(f,c,u){var d,l,g,v,s,p,T=0,F=!1,O=!1,j=!0;if(typeof f!="function")throw new TypeError(t);c=r(c)||0,n(u)&&(F=!!u.leading,O="maxWait"in u,g=O?i(r(u.maxWait)||0,c):g,j="trailing"in u?!!u.trailing:j);function x(R){var C=d,M=l;return d=l=void 0,T=R,v=f.apply(M,C),v}function A(R){return T=R,s=setTimeout(E,c),F?x(R):v}function w(R){var C=R-p,M=R-T,U=c-C;return O?a(U,g-M):U}function z(R){var C=R-p,M=R-T;return p===void 0||C>=c||C<0||O&&M>=g}function E(){var R=e();if(z(R))return D(R);s=setTimeout(E,w(R))}function D(R){return s=void 0,j&&d?x(R):(d=l=void 0,v)}function W(){s!==void 0&&clearTimeout(s),T=0,d=p=l=s=void 0}function G(){return s===void 0?v:D(e())}function I(){var R=e(),C=z(R);if(d=arguments,l=this,p=R,C){if(s===void 0)return A(p);if(O)return clearTimeout(s),s=setTimeout(E,c),x(p)}return s===void 0&&(s=setTimeout(E,c)),v}return I.cancel=W,I.flush=G,I}return ge=o,ge}var sr=Be();const dr=De(sr);var vr=function(n,e){var r=e.debounceWait,t=e.debounceLeading,i=e.debounceTrailing,a=e.debounceMaxWait,o=m.useRef(),f=m.useMemo(function(){var c={};return t!==void 0&&(c.leading=t),i!==void 0&&(c.trailing=i),a!==void 0&&(c.maxWait=a),c},[t,i,a]);return m.useEffect(function(){if(r){var c=n.runAsync.bind(n);return o.current=dr(function(u){u()},r,f),n.runAsync=function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];return new Promise(function(l,g){var v;(v=o.current)===null||v===void 0||v.call(o,function(){c.apply(void 0,P([],S(u),!1)).then(l).catch(g)})})},function(){var u;(u=o.current)===null||u===void 0||u.cancel(),n.runAsync=c}}},[r,f]),r?{onCancel:function(){var c;(c=o.current)===null||c===void 0||c.cancel()}}:{}},gr=function(n,e){var r=e.loadingDelay,t=e.ready,i=m.useRef();if(!r)return{};var a=function(){i.current&&clearTimeout(i.current)};return{onBefore:function(){return a(),t!==!1&&(i.current=setTimeout(function(){n.setState({loading:!0})},r)),{loading:!1}},onFinally:function(){a()},onCancel:function(){a()}}},Y=!!(typeof window<"u"&&window.document&&window.document.createElement);function pe(){return Y?document.visibilityState!=="hidden":!0}var V=[];function mr(n){return V.push(n),function(){var r=V.indexOf(n);V.splice(r,1)}}if(Y){var hr=function(){if(pe())for(var n=0;n<V.length;n++){var e=V[n];e()}};window.addEventListener("visibilitychange",hr,!1)}var br=function(n,e){var r=e.pollingInterval,t=e.pollingWhenHidden,i=t===void 0?!0:t,a=e.pollingErrorRetryCount,o=a===void 0?-1:a,f=m.useRef(),c=m.useRef(),u=m.useRef(0),d=function(){var l;f.current&&clearTimeout(f.current),(l=c.current)===null||l===void 0||l.call(c)};return B(function(){r||d()},[r]),r?{onBefore:function(){d()},onError:function(){u.current+=1},onSuccess:function(){u.current=0},onFinally:function(){o===-1||o!==-1&&u.current<=o?f.current=setTimeout(function(){!i&&!pe()?c.current=mr(function(){n.refresh()}):n.refresh()},r):u.current=0},onCancel:function(){d()}}:{}};function pr(n,e){var r=!1;return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];r||(r=!0,n.apply(void 0,P([],S(t),!1)),setTimeout(function(){r=!1},e))}}function yr(){return Y&&typeof navigator.onLine<"u"?navigator.onLine:!0}var k=[];function Sr(n){return k.push(n),function(){var r=k.indexOf(n);r>-1&&k.splice(r,1)}}if(Y){var Ae=function(){if(!(!pe()||!yr()))for(var n=0;n<k.length;n++){var e=k[n];e()}};window.addEventListener("visibilitychange",Ae,!1),window.addEventListener("focus",Ae,!1)}var Tr=function(n,e){var r=e.refreshOnWindowFocus,t=e.focusTimespan,i=t===void 0?5e3:t,a=m.useRef(),o=function(){var f;(f=a.current)===null||f===void 0||f.call(a)};return m.useEffect(function(){if(r){var f=pr(n.refresh.bind(n),i);a.current=Sr(function(){f()})}return function(){o()}},[r,i]),he(function(){o()}),{}},Rr=function(n,e){var r=e.retryInterval,t=e.retryCount,i=m.useRef(),a=m.useRef(0),o=m.useRef(!1);return t?{onBefore:function(){o.current||(a.current=0),o.current=!1,i.current&&clearTimeout(i.current)},onSuccess:function(){a.current=0},onError:function(){if(a.current+=1,t===-1||a.current<=t){var f=r??Math.min(1e3*Math.pow(2,a.current),3e4);i.current=setTimeout(function(){o.current=!0,n.refresh()},f)}else a.current=0},onCancel:function(){a.current=0,i.current&&clearTimeout(i.current)}}:{}},me,ze;function Pr(){if(ze)return me;ze=1;var n=Be(),e=be(),r="Expected a function";function t(i,a,o){var f=!0,c=!0;if(typeof i!="function")throw new TypeError(r);return e(o)&&(f="leading"in o?!!o.leading:f,c="trailing"in o?!!o.trailing:c),n(i,a,{leading:f,maxWait:a,trailing:c})}return me=t,me}var wr=Pr();const _r=De(wr);var Or=function(n,e){var r=e.throttleWait,t=e.throttleLeading,i=e.throttleTrailing,a=m.useRef(),o={};return t!==void 0&&(o.leading=t),i!==void 0&&(o.trailing=i),m.useEffect(function(){if(r){var f=n.runAsync.bind(n);return a.current=_r(function(c){c()},r,o),n.runAsync=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];return new Promise(function(d,l){var g;(g=a.current)===null||g===void 0||g.call(a,function(){f.apply(void 0,P([],S(c),!1)).then(d).catch(l)})})},function(){var c;n.runAsync=f,(c=a.current)===null||c===void 0||c.cancel()}}},[r,t,i]),r?{onCancel:function(){var f;(f=a.current)===null||f===void 0||f.cancel()}}:{}},jr=function(n){m.useEffect(function(){n==null||n()},[])},Er=function(){var n=S(m.useState({}),2),e=n[1];return m.useCallback(function(){return e({})},[])},Fr=function(){function n(e,r,t,i){i===void 0&&(i={}),this.serviceRef=e,this.options=r,this.subscribe=t,this.initState=i,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=b(b(b({},this.state),{loading:!r.manual}),i)}return n.prototype.setState=function(e){e===void 0&&(e={}),this.state=b(b({},this.state),e),this.subscribe()},n.prototype.runPluginHandler=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var i=this.pluginImpls.map(function(a){var o;return(o=a[e])===null||o===void 0?void 0:o.call.apply(o,P([a],S(r),!1))}).filter(Boolean);return Object.assign.apply(Object,P([{}],S(i),!1))},n.prototype.runAsync=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return ke(this,void 0,void 0,function(){var t,i,a,o,f,c,u,d,l,g,v,s,p,T,F,O,j,x,A,w,z;return Ue(this,function(E){switch(E.label){case 0:if(this.count+=1,t=this.count,i=this.runPluginHandler("onBefore",e),a=i.stopNow,o=a===void 0?!1:a,f=i.returnNow,c=f===void 0?!1:f,u=Q(i,["stopNow","returnNow"]),o)return[2,new Promise(function(){})];if(this.setState(b({loading:!0,params:e},u)),c)return[2,Promise.resolve(u.data)];(p=(s=this.options).onBefore)===null||p===void 0||p.call(s,e),E.label=1;case 1:return E.trys.push([1,3,,4]),d=this.runPluginHandler("onRequest",this.serviceRef.current,e).servicePromise,d||(d=(v=this.serviceRef).current.apply(v,P([],S(e),!1))),[4,d];case 2:return l=E.sent(),t!==this.count?[2,new Promise(function(){})]:(this.setState({data:l,error:void 0,loading:!1}),(F=(T=this.options).onSuccess)===null||F===void 0||F.call(T,l,e),this.runPluginHandler("onSuccess",l,e),(j=(O=this.options).onFinally)===null||j===void 0||j.call(O,e,l,void 0),t===this.count&&this.runPluginHandler("onFinally",e,l,void 0),[2,l]);case 3:if(g=E.sent(),t!==this.count)return[2,new Promise(function(){})];throw this.setState({error:g,loading:!1}),(A=(x=this.options).onError)===null||A===void 0||A.call(x,g,e),this.runPluginHandler("onError",g,e),(z=(w=this.options).onFinally)===null||z===void 0||z.call(w,e,void 0,g),t===this.count&&this.runPluginHandler("onFinally",e,void 0,g),g;case 4:return[2]}})})},n.prototype.run=function(){for(var e=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this.runAsync.apply(this,P([],S(r),!1)).catch(function(i){e.options.onError||console.error(i)})},n.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},n.prototype.refresh=function(){this.run.apply(this,P([],S(this.state.params||[]),!1))},n.prototype.refreshAsync=function(){return this.runAsync.apply(this,P([],S(this.state.params||[]),!1))},n.prototype.mutate=function(e){var r=$e(e)?e(this.state.data):e;this.runPluginHandler("onMutate",r),this.setState({data:r})},n}();function xr(n,e,r){e===void 0&&(e={}),r===void 0&&(r=[]);var t=e.manual,i=t===void 0?!1:t,a=e.ready,o=a===void 0?!0:a,f=Q(e,["manual","ready"]),c=b({manual:i,ready:o},f),u=Le(n),d=Er(),l=Me(function(){var g=r.map(function(v){var s;return(s=v==null?void 0:v.onInit)===null||s===void 0?void 0:s.call(v,c)}).filter(Boolean);return new Fr(u,c,d,Object.assign.apply(Object,P([{}],S(g),!1)))},[]);return l.options=c,l.pluginImpls=r.map(function(g){return g(l,c)}),jr(function(){if(!i&&o){var g=l.state.params||e.defaultParams||[];l.run.apply(l,P([],S(g),!1))}}),he(function(){l.cancel()}),{loading:l.state.loading,data:l.state.data,error:l.state.error,params:l.state.params||[],cancel:q(l.cancel.bind(l)),refresh:q(l.refresh.bind(l)),refreshAsync:q(l.refreshAsync.bind(l)),run:q(l.run.bind(l)),runAsync:q(l.runAsync.bind(l)),mutate:q(l.mutate.bind(l))}}function Cr(n,e,r){return xr(n,e,P(P([],S([]),!1),[vr,gr,br,Tr,Or,Ie,er,Rr],!1))}var qr=function(n,e){var r;e===void 0&&(e={});var t=e.defaultPageSize,i=t===void 0?10:t,a=e.defaultCurrent,o=a===void 0?1:a,f=Q(e,["defaultPageSize","defaultCurrent"]),c=Cr(n,b({defaultParams:[{current:o,pageSize:i}],refreshDepsAction:function(){F(1)}},f)),u=c.params[0]||{},d=u.current,l=d===void 0?1:d,g=u.pageSize,v=g===void 0?i:g,s=((r=c.data)===null||r===void 0?void 0:r.total)||0,p=m.useMemo(function(){return Math.ceil(s/v)},[v,s]),T=function(j,x){var A=j<=0?1:j,w=x<=0?1:x,z=Math.ceil(s/w);A>z&&(A=Math.max(1,z));var E=S(c.params||[]),D=E[0],W=D===void 0?{}:D,G=E.slice(1);c.run.apply(c,P([b(b({},W),{current:A,pageSize:w})],S(G),!1))},F=function(j){T(j,v)},O=function(j){T(l,j)};return b(b({},c),{pagination:{current:l,pageSize:v,total:s,totalPage:p,onChange:q(T),changeCurrent:q(F),changePageSize:q(O)}})},zr=function(n,e){var r;e===void 0&&(e={});var t=e.form,i=e.defaultType,a=i===void 0?"simple":i,o=e.defaultParams,f=e.manual,c=f===void 0?!1:f,u=e.refreshDeps,d=u===void 0?[]:u,l=e.ready,g=l===void 0?!0:l,v=Q(e,["form","defaultType","defaultParams","manual","refreshDeps","ready"]),s=qr(n,b(b({ready:g,manual:!0},v),{onSuccess:function(){for(var y,h=[],_=0;_<arguments.length;_++)h[_]=arguments[_];E.current=!0,(y=v.onSuccess)===null||y===void 0||y.call.apply(y,P([v],S(h),!1))}})),p=s.params,T=p===void 0?[]:p,F=s.run,O=T[2]||{},j=S(m.useState((O==null?void 0:O.type)||a),2),x=j[0],A=j[1],w=m.useRef({}),z=m.useRef([]),E=m.useRef(!1),D=!!(t!=null&&t.getInternalHooks),W=function(){if(!t)return{};if(D)return t.getFieldsValue(null,function(){return!0});var y=t.getFieldsValue(),h={};return Object.keys(y).forEach(function(_){(!t.getFieldInstance||t.getFieldInstance(_))&&(h[_]=y[_])}),h},G=function(){if(!t)return Promise.resolve({});var y=W(),h=Object.keys(y);return D?t.validateFields(h):new Promise(function(_,L){t.validateFields(h,function(H,Z){H?L(H):_(Z)})})},I=function(){if(t){if(D)return t.setFieldsValue(w.current);var y={};Object.keys(w.current).forEach(function(h){(!t.getFieldInstance||t.getFieldInstance(h))&&(y[h]=w.current[h])}),t.setFieldsValue(y)}},R=function(){var y=W();w.current=b(b({},w.current),y),A(function(h){return h==="simple"?"advance":"simple"})},C=function(y){g&&setTimeout(function(){G().then(function(h){h===void 0&&(h={});var _=y||b(b({pageSize:e.defaultPageSize||10},(T==null?void 0:T[0])||{}),{current:1});if(!t){F(_);return}w.current=b(b({},w.current),h),F(_,h,{allFormData:w.current,type:x})}).catch(function(h){return h})})},M=function(){var y,h;t&&t.resetFields(),C(b(b({},(o==null?void 0:o[0])||{}),{pageSize:e.defaultPageSize||((h=(y=e.defaultParams)===null||y===void 0?void 0:y[0])===null||h===void 0?void 0:h.pageSize)||10,current:1}))},U=function(y){var h,_,L;(h=y==null?void 0:y.preventDefault)===null||h===void 0||h.call(y),C(E.current?void 0:b({pageSize:e.defaultPageSize||((L=(_=e.defaultParams)===null||_===void 0?void 0:_[0])===null||L===void 0?void 0:L.pageSize)||10,current:1},(o==null?void 0:o[0])||{}))},Ge=function(y,h,_,L){var H=S(T||[]),Z=H[0],He=H.slice(1);F.apply(void 0,P([b(b({},Z),{current:y.current,pageSize:y.pageSize,filters:h,sorter:_,extra:L})],S(He),!1))};m.useEffect(function(){if(T.length>0){w.current=(O==null?void 0:O.allFormData)||{},I(),F.apply(void 0,P([],S(T),!1));return}g&&(w.current=(o==null?void 0:o[1])||{},I(),C(o==null?void 0:o[0]))},[]),B(function(){g&&I()},[x]);var $=m.useRef(!1);return $.current=!1,B(function(){!c&&g&&($.current=!0,t&&t.resetFields(),w.current=(o==null?void 0:o[1])||{},I(),C(o==null?void 0:o[0]))},[g]),B(function(){$.current||g&&(c||($.current=!0,s.pagination.changeCurrent(1)))},P([],S(d),!1)),b(b({},s),{tableProps:{dataSource:((r=s.data)===null||r===void 0?void 0:r.list)||z.current,loading:s.loading,onChange:q(Ge),pagination:{current:s.pagination.current,pageSize:s.pagination.pageSize,total:s.pagination.total}},search:{submit:q(U),type:x,changeType:q(R),reset:q(M)}})};export{zr as u};
